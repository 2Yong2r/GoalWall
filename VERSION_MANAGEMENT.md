# 版本管理说明

## 版本号规则

本项目采用 x.x.x 的数字格式定义程序版本（主版本号.次版本号.修订号）。

**注意**：本项目当前处于开发阶段，版本号从 0.0.0 开始。0.x.x 版本表示开发/测试版本，1.x.x 版本表示稳定版本。

### 版本号递增规则

| 版本号位置 | 名称 | 触发条件 | 示例 |
|-----------|------|---------|------|
| 第一位 | 主版本号（Major） | 调整软件架构或一次性修改超过 40% 的文件 | 0.0.0 → 1.0.0（进入稳定版） |
| 第二位 | 次版本号（Minor） | 增加新模块或一次性修改超过 10% 的文件 | 0.0.0 → 0.1.0 |
| 第三位 | 修订号（Patch） | 只是修改文件内容 | 0.0.0 → 0.0.1 |

### 开发阶段规则

在 0.x.x 开发阶段：
- 主版本号固定为 0，表示未正式发布
- 次版本号（0.x.0）表示新增功能或模块
- 修订号（0.0.x）表示 bug 修复或小改动
- 架构调整后进入 1.0.0 稳定版本

### 项目统计

- **总文件数**：52 个
- **次版本阈值**：5 个文件（10%）
- **主版本阈值**：20 个文件（40%）

## 使用方法

### 自动更新版本号

在每次提交代码后，运行以下命令自动更新版本号：

```bash
# 自动检测修改的文件数量并更新版本号
pnpm run version:update "本次修改的描述"

# 或者使用以下命令手动指定版本类型

# 修复bug，修订号+1
pnpm run version:patch

# 新增功能，次版本号+1
pnpm run version:minor

# 架构调整，主版本号+1
pnpm run version:major
```

### 版本配置文件

版本信息存储在项目根目录的 `version.json` 文件中：

```json
{
  "version": "0.2.0",
  "lastUpdated": "2026-02-11T10:40:00Z",
  "totalFiles": 52,
  "thresholds": {
    "minorVersionFiles": 5,
    "majorVersionFiles": 20
  },
  "history": [
    {
      "version": "0.2.0",
      "releaseDate": "2026-02-11T10:35:00Z",
      "description": "新增版本管理功能：自动版本号更新、版本历史记录",
      "filesModified": 11,
      "changeType": "minor"
    }
  ]
}
```

## API 接口

### 获取版本信息

```http
GET /api/v1/version
```

响应示例：

```json
{
  "success": true,
  "data": {
    "version": "0.2.0",
    "lastUpdated": "2026-02-11T10:40:00Z",
    "totalFiles": 52,
    "thresholds": {
      "minorVersionFiles": 5,
      "majorVersionFiles": 20
    },
    "history": [
      {
        "version": "0.2.0",
        "releaseDate": "2026-02-11T10:35:00Z",
        "description": "新增版本管理功能：自动版本号更新、版本历史记录",
        "filesModified": 11,
        "changeType": "minor"
      }
    ]
  }
}
```

## 应用内功能

### 设置页面

在应用的"设置"页面中，可以查看当前版本号。点击版本号可以查看完整的版本历史。

### 版本历史页面

版本历史页面显示以下信息：
- 版本号
- 发布日期
- 变更类型（架构调整/新增功能/修复优化）
- 版本描述
- 修改的文件数量

## 版本历史

| 版本号 | 发布日期 | 描述 | 变更类型 | 修改文件数 |
|-------|---------|------|---------|-----------|
| 0.2.0 | 2026-02-11 | 新增版本管理功能：自动版本号更新、版本历史记录 | minor | 11 |
| 0.1.0 | 2026-02-11 | 将任务权重改为优先级，修改目标进度计算方法 | minor | 7 |
| 0.0.0 | 2026-02-11 | 初始版本：实现基础目标管理功能 | minor | 20 |
