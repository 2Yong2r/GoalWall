# GitHub Actions æ‰‹åŠ¨æ„å»ºæŒ‡å—

## ğŸ“‹ æ¦‚è¿°

GitHub Actions å·¥ä½œæµå·²é…ç½®ä¸º**ä»…æ‰‹åŠ¨è§¦å‘**ï¼Œä¸å†è‡ªåŠ¨æ„å»ºã€‚æ¯æ¬¡ä»£ç æäº¤åï¼Œéœ€è¦äººå·¥æ‰‹åŠ¨è§¦å‘æ„å»ºæµç¨‹ã€‚

---

## ğŸš€ æ‰‹åŠ¨è§¦å‘æ„å»ºæ­¥éª¤

### æ–¹æ³•ä¸€ï¼šé€šè¿‡ GitHub Web ç•Œé¢ï¼ˆæ¨èï¼‰

1. **è®¿é—® Actions é¡µé¢**
   - æ‰“å¼€ä»“åº“ï¼šhttps://github.com/2Yong2r/GoalWall
   - ç‚¹å‡»é¡¶éƒ¨çš„ "Actions" æ ‡ç­¾

2. **é€‰æ‹©æ„å»ºå·¥ä½œæµ**
   - åœ¨å·¦ä¾§åˆ—è¡¨ä¸­æ‰¾åˆ° "Build Android APK" å·¥ä½œæµ
   - ç‚¹å‡»å·¥ä½œæµåç§°

3. **è¿è¡Œå·¥ä½œæµ**
   - ç‚¹å‡»å³ä¾§çš„ "Run workflow" æŒ‰é’®
   - é€‰æ‹©åˆ†æ”¯ï¼š`main`
   - ç‚¹å‡»ç»¿è‰²çš„ "Run workflow" æŒ‰é’®

4. **æŸ¥çœ‹æ„å»ºçŠ¶æ€**
   - æ„å»ºä¼šè‡ªåŠ¨å¼€å§‹è¿è¡Œ
   - ç‚¹å‡»æ„å»ºä»»åŠ¡å¯ä»¥æŸ¥çœ‹å®æ—¶æ—¥å¿—
   - æ„å»ºå®Œæˆåå¯ä»¥ä¸‹è½½ç”Ÿæˆçš„ APK

### æ–¹æ³•äºŒï¼šé€šè¿‡ GitHub CLI

```bash
# åˆ—å‡ºå¯ç”¨çš„å·¥ä½œæµ
gh workflow list

# è§¦å‘æ„å»º
gh workflow run build-android.yml --ref main

# æŸ¥çœ‹è¿è¡ŒçŠ¶æ€
gh run list

# æŸ¥çœ‹ç‰¹å®šè¿è¡Œçš„æ—¥å¿—
gh run view <run-id> --log
```

---

## ğŸ“¦ æ„å»ºäº§ç‰©ä¸‹è½½

### æ–¹å¼ä¸€ï¼šé€šè¿‡ Actions é¡µé¢ä¸‹è½½

1. è¿›å…¥æˆåŠŸçš„æ„å»ºä»»åŠ¡é¡µé¢
2. æ»šåŠ¨åˆ°åº•éƒ¨çš„ "Artifacts" éƒ¨åˆ†
3. ç‚¹å‡»ä¸‹è½½ï¼š
   - `app-debug.apk` - Debug ç‰ˆæœ¬
   - `app-release.apk` - Release ç‰ˆæœ¬

### æ–¹å¼äºŒï¼šé€šè¿‡ GitHub CLI ä¸‹è½½

```bash
# åˆ—å‡ºæ„å»ºäº§ç‰©
gh run view <run-id>

# ä¸‹è½½æ‰€æœ‰äº§ç‰©
gh run download <run-id>

# ä¸‹è½½ç‰¹å®šäº§ç‰©
gh run download <run-id> -n app-release
```

---

## ğŸ”§ æ„å»ºæµç¨‹è¯´æ˜

### æ„å»ºæ­¥éª¤

1. **Checkout ä»£ç ** - æ£€å‡ºæœ€æ–°ä»£ç 
2. **Setup Node.js** - è®¾ç½® Node.js 20 ç¯å¢ƒ
3. **Setup pnpm** - è®¾ç½® pnpm 9.0.0
4. **Setup Java** - è®¾ç½® Java 17 å’Œ Gradle ç¼“å­˜
5. **Cache pnpm dependencies** - ç¼“å­˜ pnpm ä¾èµ–
6. **Install dependencies** - å®‰è£…é¡¹ç›®ä¾èµ–
7. **Cache Expo** - ç¼“å­˜ Expo ç›¸å…³æ–‡ä»¶
8. **Prebuild Android** - ç”Ÿæˆ Android åŸç”Ÿé¡¹ç›®
9. **Build Debug APK** - æ„å»º Debug ç‰ˆæœ¬
10. **Build Release APK** - æ„å»º Release ç‰ˆæœ¬
11. **Upload Artifacts** - ä¸Šä¼  APK æ–‡ä»¶

### æ„å»ºäº§ç‰©

| äº§ç‰© | è·¯å¾„ | è¯´æ˜ |
|------|------|------|
| app-debug.apk | `client/android/app/build/outputs/apk/debug/` | Debug ç‰ˆæœ¬ï¼Œç”¨äºæµ‹è¯• |
| app-release.apk | `client/android/app/build/outputs/apk/release/` | Release ç‰ˆæœ¬ï¼Œç”¨äºå‘å¸ƒ |

### äº§ç‰©ä¿ç•™æ—¶é—´

- APK æ–‡ä»¶ä¿ç•™ 30 å¤©
- è¶…è¿‡ä¿ç•™æ—¶é—´åä¼šè¢«è‡ªåŠ¨åˆ é™¤

---

## ğŸ“Š æ„å»ºé…ç½®

### å·¥ä½œæµè§¦å‘æ¡ä»¶

```yaml
on:
  workflow_dispatch:  # ä»…æ‰‹åŠ¨è§¦å‘
```

- âŒ ä¸å†è‡ªåŠ¨è§¦å‘ï¼ˆpushã€pull_requestï¼‰
- âœ… ä»…æ”¯æŒæ‰‹åŠ¨è§¦å‘ï¼ˆworkflow_dispatchï¼‰

### ç¯å¢ƒé…ç½®

| é…ç½®é¡¹ | ç‰ˆæœ¬ |
|--------|------|
| Node.js | 20 |
| pnpm | 9.0.0 |
| Java | 17 (Temurin) |
| Gradle | è‡ªåŠ¨ç¼“å­˜ |

---

## âš¡ ä¼˜åŒ–å»ºè®®

### 1. æ„å»ºç¼“å­˜

- **pnpm ä¾èµ–ç¼“å­˜**ï¼šåŸºäº `pnpm-lock.yaml` çš„ hash
- **Gradle ç¼“å­˜**ï¼šè‡ªåŠ¨ç¼“å­˜ Gradle ä¾èµ–
- **Expo ç¼“å­˜**ï¼šç¼“å­˜ Expo ç›¸å…³æ–‡ä»¶

### 2. æ„å»ºæ—¶é—´

é¦–æ¬¡æ„å»ºï¼ˆæ— ç¼“å­˜ï¼‰ï¼šçº¦ 15-20 åˆ†é’Ÿ
åç»­æ„å»ºï¼ˆæœ‰ç¼“å­˜ï¼‰ï¼šçº¦ 8-12 åˆ†é’Ÿ

### 3. ç¼©çŸ­æ„å»ºæ—¶é—´

- ä¿æŒ `pnpm-lock.yaml` ç¨³å®šï¼ˆä¸è¦é¢‘ç¹ä¿®æ”¹ä¾èµ–ï¼‰
- åˆ©ç”¨ç¼“å­˜æœºåˆ¶
- ä»…åœ¨éœ€è¦æ—¶è§¦å‘æ„å»º

---

## ğŸ› å¸¸è§é—®é¢˜

### Q1: æ„å»ºå¤±è´¥æ€ä¹ˆåŠï¼Ÿ

A:
1. æŸ¥çœ‹æ„å»ºæ—¥å¿—ï¼Œå®šä½é”™è¯¯ä¿¡æ¯
2. æ£€æŸ¥ä»£ç æ˜¯å¦åœ¨æœ¬åœ°é€šè¿‡æ„å»ºæ£€æŸ¥
3. ä¿®å¤é—®é¢˜åé‡æ–°è§¦å‘æ„å»º

### Q2: å¦‚ä½•æŸ¥çœ‹æ„å»ºå†å²ï¼Ÿ

A:
1. è¿›å…¥ Actions é¡µé¢
2. ç‚¹å‡»å·¦ä¾§çš„ "Build Android APK" å·¥ä½œæµ
3. æŸ¥çœ‹æ‰€æœ‰å†å²è¿è¡Œè®°å½•

### Q3: æ„å»ºäº§ç‰©å¯ä»¥ä¿ç•™å¤šä¹…ï¼Ÿ

A: APK æ–‡ä»¶é»˜è®¤ä¿ç•™ 30 å¤©ï¼Œè¶…è¿‡åä¼šè¢«è‡ªåŠ¨åˆ é™¤ã€‚

### Q4: å¦‚ä½•ä¿®æ”¹ä¿ç•™æ—¶é—´ï¼Ÿ

A: ç¼–è¾‘ `.github/workflows/build-android.yml` æ–‡ä»¶ï¼š
```yaml
- name: Upload Debug APK
  uses: actions/upload-artifact@v4
  with:
    retention-days: 90  # ä¿®æ”¹ä¿ç•™å¤©æ•°
```

### Q5: å¯ä»¥ä¸ºç‰¹å®šåˆ†æ”¯è‡ªåŠ¨æ„å»ºå—ï¼Ÿ

A: å¯ä»¥ä¿®æ”¹ `on` éƒ¨åˆ†ï¼š
```yaml
on:
  push:
    branches: [ release ]  # ä»… release åˆ†æ”¯è‡ªåŠ¨æ„å»º
  workflow_dispatch:  # æ‰‹åŠ¨è§¦å‘
```

---

## ğŸ“ æœ€ä½³å®è·µ

### 1. æäº¤ç­–ç•¥

- âœ… é¢‘ç¹æäº¤ä»£ç ï¼ˆä¸è§¦å‘æ„å»ºï¼‰
- âœ… ä»…åœ¨éœ€è¦ APK æ—¶æ‰‹åŠ¨è§¦å‘æ„å»º
- âœ… ä½¿ç”¨åˆ†æ”¯ç®¡ç†åŠŸèƒ½å¼€å‘

### 2. æ„å»ºæ—¶æœº

å»ºè®®åœ¨ä»¥ä¸‹æƒ…å†µè§¦å‘æ„å»ºï¼š
- å‘å¸ƒæ–°ç‰ˆæœ¬
- æµ‹è¯•æ ¸å¿ƒåŠŸèƒ½
- ç”Ÿæˆæµ‹è¯•ç‰ˆæœ¬ç»™ä»–äººä½¿ç”¨

### 3. ç‰ˆæœ¬ç®¡ç†

- ä½¿ç”¨ Git Tag æ ‡è®°ç‰ˆæœ¬ï¼ˆå¦‚ `v1.0.0`ï¼‰
- Tag ä¼šè§¦å‘ Release åˆ›å»º
- åœ¨ Release ä¸­å¯ä»¥æ°¸ä¹…ä¿å­˜ APK

---

## ğŸ”— ç›¸å…³é“¾æ¥

- [GitHub Actions æ–‡æ¡£](https://docs.github.com/en/actions)
- [workflow_dispatch äº‹ä»¶](https://docs.github.com/en/actions/using-workflows/events-that-trigger-workflows#workflow_dispatch)
- [GitHub CLI æ–‡æ¡£](https://cli.github.com/manual/)

---

**æ›´æ–°æ—¶é—´**ï¼š2025-02-11
